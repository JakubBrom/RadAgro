

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RadAgro &mdash; Dokumentace pro RadAgro 0.1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Rejstřík"
              href="../genindex.html"/>
        <link rel="search" title="Vyhledávání" href="../search.html"/>
    <link rel="top" title="Dokumentace pro RadAgro 0.1" href="../index.html"/>
        <link rel="up" title="Kód modulu" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> RadAgro
          

          
            
            <img src="../_static/icon.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../users_man.html">Instalace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_man.html#vstupni-data">Vstupní data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_man.html#uzivatelske-rozhrani-a-zadavani-dat">Uživatelské rozhraní a zadávání dat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_man.html#nastaveni-parametru-vypoctu">Nastavení parametrů výpočtu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_man.html#vysledky-vypoctu">Výsledky výpočtu</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../description.html">Struktura programu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#rustova-analyza">Růstová analýza</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#hydrologie">Hydrologie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#erozni-model">Erozní model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#prenos-radioaktivni-kontaminace-v-biomase">Přenos radioaktivní kontaminace v biomase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#radioaktivni-premena">Radioaktivní přeměna</a></li>
<li class="toctree-l1"><a class="reference internal" href="../description.html#referencni-urovne-kontaminace-biomasy">Referenční úrovně kontaminace biomasy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../libs.html">Program structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-radagro">Module RadAgro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-activity-decay">Module activity_decay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-hydrio">Module hydrIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-sarca-lib">Module SARCA_lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-usle">Module usle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-waterflow">Module waterflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-mdaylight">Module mdaylight</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-sowing-proc">Module sowing_proc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#module-overlap-clip">Module overlap_clip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#parameter-of-crops-and-soil-settings">Parameter of crops and soil settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../libs.html#known-issues">Known issues</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Licenční ujednání</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ackn.html">Poděkování</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../literature.html">Přehled literatury</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RadAgro</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Kód modulu</a> &raquo;</li>
        
      <li>RadAgro</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Zdrojový kód pro RadAgro</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">#  Project: RadAgro</span>
<span class="c1">#  File: RadAgro.py</span>
<span class="c1">#</span>
<span class="c1">#  Author: Dr. Jakub Brom</span>
<span class="c1">#</span>
<span class="c1">#  Copyright (c) 2020. Dr. Jakub Brom, University of South Bohemia in</span>
<span class="c1">#  České Budějovice, Faculty of Agriculture.</span>
<span class="c1">#</span>
<span class="c1">#  This program is free software: you can redistribute it and/or modify</span>
<span class="c1">#      it under the terms of the GNU General Public License as published by</span>
<span class="c1">#      the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">#      (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1">#      This program is distributed in the hope that it will be useful,</span>
<span class="c1">#      but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">#      GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#      You should have received a copy of the GNU General Public License</span>
<span class="c1">#      along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;</span>
<span class="c1">#</span>
<span class="c1">#  Last changes: 28.12.20 16:46</span>
<span class="c1">#</span>
<span class="c1">#  Begin: 2020/10/23</span>


<span class="kn">from</span> <span class="nn">qgis.PyQt.QtCore</span> <span class="k">import</span> <span class="n">QSettings</span><span class="p">,</span> <span class="n">QTranslator</span><span class="p">,</span> \
    <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QUrl</span><span class="p">,</span> <span class="n">QDate</span><span class="p">,</span> <span class="n">QThread</span><span class="p">,</span> <span class="n">QObject</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtGui</span> <span class="k">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QDesktopServices</span><span class="p">,</span> <span class="n">QPixmap</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtWidgets</span> <span class="k">import</span> <span class="n">QAction</span><span class="p">,</span> <span class="n">QComboBox</span><span class="p">,</span> \
    <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">,</span> <span class="n">QDateEdit</span><span class="p">,</span> \
    <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QDoubleSpinBox</span><span class="p">,</span> <span class="n">QCompleter</span><span class="p">,</span> <span class="n">QProgressBar</span><span class="p">,</span> \
    <span class="n">QDialogButtonBox</span>

<span class="c1"># Initialize Qt resources from file resources.py</span>
<span class="kn">from</span> <span class="nn">resources</span> <span class="k">import</span> <span class="o">*</span> <span class="c1"># TODO</span>

<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="k">import</span> <span class="n">Qgis</span><span class="p">,</span> <span class="n">QgsMapLayerProxyModel</span><span class="p">,</span> <span class="n">QgsProject</span><span class="p">,</span> \
    <span class="n">QgsVectorLayer</span>

<span class="c1"># Import the code for the dialog</span>
<span class="kn">from</span> <span class="nn">RadAgro_dialog</span> <span class="k">import</span> <span class="n">RadAgroDialog</span>    <span class="c1"># TODO</span>

<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="k">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> \
    <span class="n">FigureCanvas</span><span class="p">,</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Import modules    # TODO</span>
<span class="kn">from</span> <span class="nn">modules.SARCA_lib</span> <span class="k">import</span> <span class="n">SARCALib</span>
<span class="kn">from</span> <span class="nn">modules.sowing_proc</span> <span class="k">import</span> <span class="n">SowingProcTimeSeries</span>
<span class="kn">from</span> <span class="nn">modules.activity_decay</span> <span class="k">import</span> <span class="n">ActivityDecay</span>
<span class="kn">from</span> <span class="nn">modules.usle</span> <span class="k">import</span> <span class="n">RadUSLE</span>
<span class="kn">from</span> <span class="nn">modules.overlap_clip</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">modules.hydrIO</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">modules.zonal_stats</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SARCALib</span><span class="p">()</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">SowingProcTimeSeries</span><span class="p">()</span>
<span class="n">ad</span> <span class="o">=</span> <span class="n">ActivityDecay</span><span class="p">()</span>
<span class="n">ru</span> <span class="o">=</span> <span class="n">RadUSLE</span><span class="p">()</span>


<div class="viewcode-block" id="RadAgro"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro">[dokumentace]</a><span class="k">class</span> <span class="nc">RadAgro</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;QGIS Plugin Implementation.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iface</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        :param iface: An interface instance that will be passed to</span>
<span class="sd">        this class which provides the hook by which you can</span>
<span class="sd">        manipulate the QGIS application at run time.</span>
<span class="sd">        :type iface: QgsInterface</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Save reference to the QGIS interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span> <span class="o">=</span> <span class="n">iface</span>
        <span class="c1"># initialize plugin directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
        <span class="c1"># initialize locale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;locale/userLocale&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">locale_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
            <span class="s1">&#39;i18n&#39;</span><span class="p">,</span>
            <span class="s1">&#39;RadAgro_</span><span class="si">{}</span><span class="s1">.qm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">locale_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span> <span class="o">=</span> <span class="n">QTranslator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">locale_path</span><span class="p">)</span>
            <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">installTranslator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="p">)</span>

        <span class="c1"># Declare instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&amp;RadAgro&#39;</span><span class="p">)</span>

        <span class="c1"># Check if plugin was started the first time in current QGIS session</span>
        <span class="c1"># Must be set in initGui() to survive plugin reloads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginIsActive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Read constants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># noinspection PyMethodMayBeStatic</span>
<div class="viewcode-block" id="RadAgro.tr"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.tr">[dokumentace]</a>    <span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the translation for a string using Qt translation API.</span>

<span class="sd">        We implement this ourselves since we do not inherit QObject.</span>

<span class="sd">        :param message: String for translation.</span>
<span class="sd">        :type message: str, QString</span>

<span class="sd">        :returns: Translated version of message.</span>
<span class="sd">        :rtype: QString</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># noinspection PyTypeChecker,PyArgumentList,PyCallByClass</span>
        <span class="k">return</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s1">&#39;RadAgro&#39;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.add_action"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.add_action">[dokumentace]</a>    <span class="k">def</span> <span class="nf">add_action</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">icon_path</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">,</span>
        <span class="n">enabled_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_to_menu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">add_to_toolbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">status_tip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">whats_this</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a toolbar icon to the toolbar.</span>

<span class="sd">        :param icon_path: Path to the icon for this action. Can be a resource</span>
<span class="sd">            path (e.g. &#39;:/plugins/foo/bar.png&#39;) or a normal file system path.</span>
<span class="sd">        :type icon_path: str</span>

<span class="sd">        :param text: Text that should be shown in menu items for this action.</span>
<span class="sd">        :type text: str</span>

<span class="sd">        :param callback: Function to be called when the action is triggered.</span>
<span class="sd">        :type callback: function</span>

<span class="sd">        :param enabled_flag: A flag indicating if the action should be enabled</span>
<span class="sd">            by default. Defaults to True.</span>
<span class="sd">        :type enabled_flag: bool</span>

<span class="sd">        :param add_to_menu: Flag indicating whether the action should also</span>
<span class="sd">            be added to the menu. Defaults to True.</span>
<span class="sd">        :type add_to_menu: bool</span>

<span class="sd">        :param add_to_toolbar: Flag indicating whether the action should also</span>
<span class="sd">            be added to the toolbar. Defaults to True.</span>
<span class="sd">        :type add_to_toolbar: bool</span>

<span class="sd">        :param status_tip: Optional text to show in a popup when mouse pointer</span>
<span class="sd">            hovers over the action.</span>
<span class="sd">        :type status_tip: str</span>

<span class="sd">        :param parent: Parent widget for the new action. Defaults None.</span>
<span class="sd">        :type parent: QWidget</span>

<span class="sd">        :param whats_this: Optional text to show in the status bar when the</span>
<span class="sd">            mouse pointer hovers over the action.</span>

<span class="sd">        :returns: The action that was created. Note that the action is also</span>
<span class="sd">            added to self.actions list.</span>
<span class="sd">        :rtype: QAction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">icon_path</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled_flag</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">status_tip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="n">status_tip</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">whats_this</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setWhatsThis</span><span class="p">(</span><span class="n">whats_this</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_toolbar</span><span class="p">:</span>
            <span class="c1"># Adds plugin icon to Plugins toolbar</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_to_menu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addPluginToMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">,</span>
                <span class="n">action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">action</span></div>

<div class="viewcode-block" id="RadAgro.initGui"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.initGui">[dokumentace]</a>    <span class="k">def</span> <span class="nf">initGui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the menu entries and toolbar icons inside the QGIS GUI.&quot;&quot;&quot;</span>

        <span class="n">icon_path</span> <span class="o">=</span> <span class="s1">&#39;:/plugins/RadAgro/icon.png&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span>
            <span class="n">icon_path</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;RadAgro&#39;</span><span class="p">),</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">())</span>

        <span class="c1"># Create the dialog with elements (after translation) and keep reference</span>
        <span class="c1"># Only create GUI ONCE in callback, so that it will only load when the plugin is started</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginIsActive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pluginIsActive</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">RadAgroDialog</span><span class="p">()</span>

        <span class="c1"># Help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">button_box</span><span class="o">.</span><span class="n">helpRequested</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginHelp</span><span class="p">)</span>

        <span class="c1"># Set disabled OK dialog button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">button_box</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Run results calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">button_box</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resultsRun</span><span class="p">)</span>

        <span class="c1"># Set initial index of cbox_precip as 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_precip</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Add rows to sowing procedure table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pb_sow_plus</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">cropTableAddRow</span><span class="p">(</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_sowing</span><span class="p">))</span>
        
        <span class="c1"># Add rows to meadows table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pb_meadow_plus</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">meadowTableAddRow</span><span class="p">(</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_meadow</span><span class="p">))</span>

        <span class="c1"># Remove rows from sowing proc table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pb_sow_minus</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">tableRemoveRow</span><span class="p">(</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_sowing</span><span class="p">))</span>

        <span class="c1"># Remove rows from meadow table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pb_meadow_minus</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">tableRemoveRow</span><span class="p">(</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_meadow</span><span class="p">))</span>

        <span class="c1"># Create figure after fid selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_y_scale</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span>

        <span class="c1"># Create plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>  <span class="c1"># create plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="c1"># toolbar = NavigationToolbar(self.canvas, self)</span>

        <span class="c1"># Add plot in to UI widget</span>
        <span class="n">lay</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">widget_plot</span><span class="p">)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># lay.addWidget(toolbar)</span>
        <span class="n">lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span></div>
        <span class="c1"># self.setLayout(lay)</span>

<div class="viewcode-block" id="RadAgro.unload"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.unload">[dokumentace]</a>    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes the plugin menu item and icon from QGIS GUI.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removePluginMenu</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&amp;RadAgro&#39;</span><span class="p">),</span>
                <span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">removeToolBarIcon</span><span class="p">(</span><span class="n">action</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.run"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.run">[dokumentace]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run method that performs all the real work&quot;&quot;&quot;</span>

        <span class="c1"># print &quot;** STARTING UrbanSARCA&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showInfo</span><span class="p">()</span>

        <span class="c1"># set tab with graph disabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Hide hydrology tabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">toolBox</span><span class="o">.</span><span class="n">setItemEnabled</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">toolBox_2</span><span class="o">.</span><span class="n">setItemEnabled</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Set type of input to input cboxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_rad_depo</span><span class="o">.</span><span class="n">setFilters</span><span class="p">(</span>
            <span class="n">QgsMapLayerProxyModel</span><span class="o">.</span><span class="n">RasterLayer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_precip</span><span class="o">.</span><span class="n">setFilters</span><span class="p">(</span>
            <span class="n">QgsMapLayerProxyModel</span><span class="o">.</span><span class="n">RasterLayer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="o">.</span><span class="n">setFilters</span><span class="p">(</span>
            <span class="n">QgsMapLayerProxyModel</span><span class="o">.</span><span class="n">PolygonLayer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ</span><span class="o">.</span><span class="n">setFilters</span><span class="p">(</span>
            <span class="n">QgsMapLayerProxyModel</span><span class="o">.</span><span class="n">PolygonLayer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_dmt</span><span class="o">.</span><span class="n">setFilters</span><span class="p">(</span>
            <span class="n">QgsMapLayerProxyModel</span><span class="o">.</span><span class="n">RasterLayer</span><span class="p">)</span>

        <span class="c1"># If precipitation is constant the cbox for precipitation</span>
        <span class="c1"># raster is empty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">rb_precip_konst</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setCboxEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_precip</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">rb_precip_rast</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_precip</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="c1"># If raster of precipitation is selected, value in spinbox is set</span>
        <span class="c1"># to 0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">rb_precip_rast</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_precip</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">0.00</span><span class="p">))</span>

        <span class="c1"># Set fields from crop layer to fieldCbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="o">.</span><span class="n">layerChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">setKeyField</span><span class="p">(</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr_key</span><span class="p">))</span>
        <span class="c1">#</span>
        <span class="c1"># # Set fields from crop layer to fieldCbox</span>
        <span class="c1"># self.dlg.cbox_crop_lyr.layerChanged.connect(lambda:</span>
        <span class="c1">#                                             self.setKeyField(</span>
        <span class="c1">#                                                 self.dlg.cbox_crop_lyr, self.dlg.cbox_ID))</span>

        <span class="c1"># Set fields from HPJ layer to fieldCbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ</span><span class="o">.</span><span class="n">layerChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">setKeyField</span><span class="p">(</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ_key</span><span class="p">))</span>

        <span class="c1"># Set particular crops defined by user to tw_crops_orig table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr_key</span><span class="o">.</span><span class="n">fieldChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">setOrigCropsToTable</span><span class="p">())</span>

        <span class="c1"># Set IDs of fields to cbox_select_ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="o">.</span><span class="n">layerChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readIDField</span><span class="p">())</span>

        <span class="c1"># Set soil saturation during the year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setClimateTable</span><span class="p">()</span>

        <span class="c1"># Set parameters of the crops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pb_params</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillParams</span><span class="p">())</span>

        <span class="c1"># Set default slope and intercept coefficients of the growth</span>
        <span class="c1"># model to growth model table for particular</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">pb_coefs</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateGowthCurveCoefs</span><span class="p">())</span>

        <span class="c1"># show the dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<span class="c1">#-----------------------------------------------------------------------</span>
<span class="c1"># Calculation</span>

<div class="viewcode-block" id="RadAgro.resultsRun"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.resultsRun">[dokumentace]</a>    <span class="k">def</span> <span class="nf">resultsRun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the process of calculation in threads&quot;&quot;&quot;</span>

        <span class="c1"># Read constants from UI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readConstants</span><span class="p">()</span>
        <span class="c1"># Read HPJ field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">su_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ_key</span><span class="o">.</span><span class="n">currentField</span><span class="p">()</span>
        <span class="c1"># Run Working thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startWorker</span><span class="p">()</span></div>

<div class="viewcode-block" id="RadAgro.resultsCalculate"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.resultsCalculate">[dokumentace]</a>    <span class="k">def</span> <span class="nf">resultsCalculate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Running the calculation without threading and progress bar</span>
<span class="sd">        showing.&quot;&quot;&quot;</span>

        <span class="c1"># Main soil units layer path and field name</span>
        <span class="n">su_lyr_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ</span><span class="p">)</span>
        <span class="n">su_field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ_key</span><span class="o">.</span><span class="n">currentField</span><span class="p">()</span>

        <span class="c1"># Crops layer path</span>
        <span class="n">crops_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="p">)</span>

        <span class="c1"># Load rasters of radioactivity, precip. and DMT and clip to</span>
        <span class="c1"># the overlapping area with the smallest pixel</span>
        <span class="n">depo_path</span><span class="p">,</span> <span class="n">precip_path</span><span class="p">,</span> <span class="n">dmt_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadRasters</span><span class="p">()</span>

        <span class="c1"># Loading crops layer and creating initial crops dataframe</span>
        <span class="n">df_crops_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createCropsInitDf</span><span class="p">(</span><span class="n">crops_path</span><span class="p">)</span>

        <span class="c1"># Read crops growth model data from UI</span>
        <span class="n">df_growth_model_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readGrowthModelParams</span><span class="p">()</span>

        <span class="c1"># Read transfer coefficients from UI</span>
        <span class="n">df_transf_coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readTransferCoef</span><span class="p">()</span>

        <span class="c1"># Calculate early stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">earlyStage</span><span class="p">(</span><span class="n">depo_path</span><span class="p">,</span> <span class="n">precip_path</span><span class="p">,</span> <span class="n">crops_path</span><span class="p">,</span> 
                        <span class="n">df_crops_init</span><span class="p">)</span>

        <span class="c1"># Read crops rotation data and meadows cutting data from UI</span>
        <span class="n">df_crops_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCropsRotation</span><span class="p">()</span>
        <span class="n">df_meadows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readMeadowsCut</span><span class="p">()</span>

        <span class="c1"># Create time series for crops</span>
        <span class="n">df_crops_rotation_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createCropsRotationTS</span><span class="p">(</span>
            <span class="n">df_crops_init</span><span class="p">,</span> <span class="n">df_crops_rotation</span><span class="p">,</span> <span class="n">df_meadows</span><span class="p">)</span>
        <span class="n">df_crops_harvest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createCropsHarvestTS</span><span class="p">(</span><span class="n">df_crops_init</span><span class="p">,</span>
                                                          <span class="n">df_crops_rotation</span><span class="p">,</span>
                                                          <span class="n">df_meadows</span><span class="p">)</span>
        <span class="n">df_crops_dw_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createDryMassTS</span><span class="p">(</span><span class="n">df_crops_init</span><span class="p">,</span>
                                                    <span class="n">df_growth_model_params</span><span class="p">,</span>
                                                    <span class="n">df_crops_rotation</span><span class="p">,</span>
                                                    <span class="n">df_meadows</span><span class="p">)</span>

        <span class="c1"># Calculate USLE</span>
        <span class="n">k_factor_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readKFactorTable</span><span class="p">()</span>
        <span class="n">k_factor</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">fK</span><span class="p">(</span><span class="n">su_lyr_path</span><span class="p">,</span> <span class="n">su_field</span><span class="p">,</span> <span class="n">k_factor_tab</span><span class="p">,</span>
                         <span class="n">crops_path</span><span class="p">)</span>
        <span class="n">ls_factor</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">fLS</span><span class="p">(</span><span class="n">dmt_path</span><span class="p">,</span> <span class="n">crops_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_m</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_n</span><span class="p">)</span>
        <span class="n">c_factor_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCFactorTable</span><span class="p">()</span>
        <span class="n">r_perc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readRFactorPercTable</span><span class="p">()</span>

        <span class="c1"># Calculate hydrology</span>
        <span class="c1"># TODO</span>

        <span class="c1"># Calculate total radioactive contamination time series table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateRadioactiveContamination</span><span class="p">(</span><span class="n">df_transf_coefs</span><span class="p">,</span>
                                               <span class="n">df_crops_rotation_all</span><span class="p">,</span>
                                               <span class="n">df_crops_harvest</span><span class="p">,</span>
                                               <span class="n">df_crops_dw_all</span><span class="p">,</span>
                                               <span class="n">k_factor</span><span class="p">,</span> <span class="n">ls_factor</span><span class="p">,</span>
                                               <span class="n">c_factor_tab</span><span class="p">,</span> <span class="n">r_perc</span><span class="p">)</span>

        <span class="c1"># Export data</span>
        <span class="c1"># self.exportTablesToCsv()        # Export to csv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportRadioCont2GeoPackage</span><span class="p">()</span>

        <span class="c1"># The page with graph enabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="RadAgro.readConstants"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readConstants">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readConstants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read all constants from UI&quot;&quot;&quot;</span>

        <span class="c1"># Date of radiation accident</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accident_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">de_accident</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accident_jul</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accident_date</span><span class="o">.</span><span class="n">dayOfYear</span><span class="p">()</span>

        <span class="c1"># Early stage management</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">early</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">chbox_management</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

        <span class="c1"># Date of prediction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">de_predict</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">accident_date</span><span class="o">.</span><span class="n">month</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">predict_date</span><span class="o">.</span><span class="n">year</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">accident_date</span><span class="o">.</span><span class="n">year</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span> <span class="o">+</span> \
                                 <span class="bp">self</span><span class="o">.</span><span class="n">predict_date</span><span class="o">.</span><span class="n">month</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_month</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accident_date</span><span class="o">.</span><span class="n">month</span><span class="p">()</span>

        <span class="c1"># Reference levels of radioactivity contamination</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rl_1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_ru1</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rl_2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_ru2</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

        <span class="c1"># Coefficients for interception factor calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radionuclide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_contaminant</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radionuclide</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coef_k</span> <span class="o">=</span> <span class="mf">1.0</span>       <span class="c1"># Cs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coef_k</span> <span class="o">=</span> <span class="mf">2.0</span>       <span class="c1"># Sr</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coef_S</span> <span class="o">=</span> <span class="mf">0.2</span>

        <span class="c1"># Precipitation amount during radioactivity deposition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precip_const</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_precip</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="c1"># Erosion constants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_factor_const</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_r_factor</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_LS_m</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_LS_n</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_P_fact</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_soil_depth</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_vol_mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">sbox_vol_soil</span><span class="o">.</span><span class="n">value</span><span class="p">()</span></div>

<div class="viewcode-block" id="RadAgro.loadRasters"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.loadRasters">[dokumentace]</a>    <span class="k">def</span> <span class="nf">loadRasters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reading rasters of radioactivity deposition, precipitation</span>
<span class="sd">        and DMT.&quot;&quot;&quot;</span>

        <span class="c1"># Read original rasters</span>
        <span class="n">depo_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_rad_depo</span><span class="p">)</span>
        <span class="n">precip_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_precip</span><span class="p">)</span>
        <span class="n">dmt_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_dmt</span><span class="p">)</span>

        <span class="c1"># Clipping the rasters</span>
        <span class="k">if</span> <span class="n">precip_path</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">precip_path</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">in_lyrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">depo_path</span><span class="p">,</span> <span class="n">precip_path</span><span class="p">,</span> <span class="n">dmt_path</span><span class="p">]</span>
            <span class="p">(</span><span class="n">depo_path_new</span><span class="p">,</span> <span class="n">precip_path_new</span><span class="p">,</span> <span class="n">dmt_path_new</span><span class="p">)</span> <span class="o">=</span> \
                <span class="n">clipOverlappingArea</span><span class="p">(</span><span class="n">in_lyrs</span><span class="p">,</span> <span class="n">tmp_out</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_lyrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">depo_path</span><span class="p">,</span> <span class="n">dmt_path</span><span class="p">]</span>
            <span class="p">(</span><span class="n">depo_path_new</span><span class="p">,</span> <span class="n">dmt_path_new</span><span class="p">)</span> <span class="o">=</span> \
                <span class="n">clipOverlappingArea</span><span class="p">(</span><span class="n">in_lyrs</span><span class="p">,</span> <span class="n">tmp_out</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">precip_path_new</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Get temporary folder path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">depo_path_new</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">depo_path_new</span><span class="p">,</span> <span class="n">precip_path_new</span><span class="p">,</span> <span class="n">dmt_path_new</span></div>

<div class="viewcode-block" id="RadAgro.createCropsInitDf"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.createCropsInitDf">[dokumentace]</a>    <span class="k">def</span> <span class="nf">createCropsInitDf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crops_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read indices of crops corresponding to original crops from</span>
<span class="sd">        tw_crops_orig table and write them to the initial vector</span>
<span class="sd">        layer</span>

<span class="sd">        :param crops_path: path to crops vector layer</span>

<span class="sd">        :return: initial dataframe for crops and following</span>
<span class="sd">            calculation results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get number of rows in the table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Read original IDs (keys) and newly set IDs for particular crops</span>
        <span class="c1"># from the tw_crops_orig table</span>
        <span class="n">crops_IDs_orig_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>
        <span class="n">crops_IDs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>
        <span class="n">crops_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>

        <span class="n">df_crops_coupling</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_orig&quot;</span><span class="p">:</span><span class="n">crops_IDs_orig_list</span><span class="p">,</span>
                                       <span class="s2">&quot;ID_set&quot;</span><span class="p">:</span><span class="n">crops_IDs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span>
                <span class="s2">&quot;Nazev&quot;</span><span class="p">):</span><span class="n">crops_names</span><span class="p">})</span>

        <span class="c1"># Load crops layer to qgis</span>
        <span class="n">crops_lyr</span> <span class="o">=</span> <span class="n">QgsVectorLayer</span><span class="p">(</span><span class="n">crops_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span>
            <span class="s2">&quot;Plodiny_orig&quot;</span><span class="p">),</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>

        <span class="c1"># Read original crops IDs from crop vector - for all rows</span>
        <span class="n">crop_IDs_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr_key</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">crops_IDs_orig_list_all</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">crops_lyr</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
            <span class="n">crops_IDs_orig_list_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">[</span><span class="n">crop_IDs_field_name</span><span class="p">])</span>

        <span class="c1"># Read FID field from crop layer</span>
        <span class="n">crops_fid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">crops_lyr</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
            <span class="n">crops_fid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">id</span><span class="p">())</span>

        <span class="c1"># Calculate area of fields in the vector layer</span>
        <span class="n">crops_area_ha</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">crops_lyr</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
            <span class="n">crops_area_ha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">area</span><span class="p">()</span><span class="o">/</span><span class="mi">10000</span><span class="p">)</span>

        <span class="c1"># Create new Pandas dataframe containing IDs of fields,</span>
        <span class="c1"># crops_IDs and crops_names corresponding to the vector layer</span>
        <span class="n">df_crops_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;fid&quot;</span><span class="p">:</span><span class="n">crops_fid</span><span class="p">,</span>
                                      <span class="s2">&quot;ID_orig&quot;</span><span class="p">:</span><span class="n">crops_IDs_orig_list_all</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Plocha_ha&quot;</span><span class="p">):</span><span class="n">crops_area_ha</span><span class="p">})</span>

        <span class="c1"># Merge df_crops_coupling and df_crops_rows to initial dataframe</span>
        <span class="n">df_crops_init</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_crops_rows</span><span class="p">,</span> <span class="n">df_crops_coupling</span><span class="p">,</span>
                                      <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;ID_orig&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_crops_init</span></div>

<div class="viewcode-block" id="RadAgro.earlyStage"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.earlyStage">[dokumentace]</a>    <span class="k">def</span> <span class="nf">earlyStage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depo_path</span><span class="p">,</span> <span class="n">precip_path</span><span class="p">,</span> <span class="n">crops_path</span><span class="p">,</span>
                   <span class="n">df_crops_init</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculation of radioactive contamination in early stage of</span>
<span class="sd">        radioactive accident.</span>

<span class="sd">        :param depo_path: Path to raster with deposition</span>
<span class="sd">            :math:`(Bq.m^{-1})`</span>
<span class="sd">        :param precip_path: Path to raster with precipitation (mm)</span>
<span class="sd">        :param crops_path: Path to crops vector layer</span>
<span class="sd">        :param df_crops_init: Initial crops dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create df for radioactive contamination</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span> <span class="o">=</span> <span class="n">df_crops_init</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Calculation of total deposition for all fields in the area of interest</span>
        <span class="n">total_depo_zonal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">zonal_stats</span><span class="p">(</span><span class="n">crops_path</span><span class="p">,</span>
                                       <span class="n">depo_path</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">))</span>
        <span class="n">total_deposition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">total_depo_zonal</span><span class="p">[</span><span class="s2">&quot;median&quot;</span><span class="p">])</span>
        <span class="n">total_deposition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">total_deposition</span><span class="p">)</span>
        <span class="n">total_deposition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">total_deposition</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">total_deposition</span><span class="p">)</span>

        <span class="c1"># Add initial total deposition to df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="p">[</span><span class="s2">&quot;Tot_depo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_deposition</span>

        <span class="c1"># Create df for reference levels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_ref_levels</span> <span class="o">=</span> <span class="n">df_crops_init</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Calculated Ref.levels and add them to df</span>
        <span class="n">ref_levels</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">referLevel</span><span class="p">(</span><span class="n">total_deposition</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rl_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rl_2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">df_ref_levels</span><span class="p">[</span><span class="s2">&quot;Init_Ref_levels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_levels</span>

        <span class="c1"># Calculates total radioactive contamination after biomass removing</span>
        <span class="c1"># in early stage of radioactive contamination</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">chbox_management</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="c1"># Reading data from tw_growth_params table</span>
            <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

            <span class="n">model_IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">model_sowing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">dayOfYear</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">model_harvest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">dayOfYear</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">model_DWmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">model_LAImax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">model_R_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">model_coef_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">model_coef_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

            <span class="c1"># Calculation of dry mass of biomass and LAI for accident date</span>
            <span class="n">actual_DW</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">dryMass</span><span class="p">(</span><span class="n">model_DWmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">accident_jul</span><span class="p">,</span>
                                   <span class="n">model_sowing</span><span class="p">,</span> <span class="n">model_harvest</span><span class="p">,</span> <span class="n">model_coef_m</span><span class="p">,</span>
                                   <span class="n">model_coef_n</span><span class="p">)</span>
            <span class="n">actual_LAI</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">leafAreaIndex</span><span class="p">(</span><span class="n">actual_DW</span><span class="p">,</span> <span class="n">model_DWmax</span><span class="p">,</span>
                                          <span class="n">model_LAImax</span><span class="p">,</span> <span class="n">model_R_min</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">accident_jul</span><span class="p">,</span> <span class="n">model_sowing</span><span class="p">,</span>
                                          <span class="n">model_harvest</span><span class="p">)</span>

            <span class="c1"># Create table with results for dw_act and LAI</span>
            <span class="n">dw_lai_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:</span><span class="n">model_IDs</span><span class="p">,</span> <span class="s2">&quot;dw_act&quot;</span><span class="p">:</span><span class="n">actual_DW</span><span class="p">,</span>
                                         <span class="s2">&quot;LAI&quot;</span><span class="p">:</span><span class="n">actual_LAI</span><span class="p">})</span>

            <span class="c1"># Join dw_act and LAI to new df corresponding with the input vector</span>
            <span class="c1"># layer</span>
            <span class="n">df_dw_lai_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_crops_init</span><span class="p">,</span> <span class="n">dw_lai_table</span><span class="p">,</span>
                                     <span class="n">on</span><span class="o">=</span><span class="s2">&quot;ID_set&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

            <span class="c1"># Calculation of soil contamination</span>
            <span class="c1"># Precipitation</span>
            <span class="k">if</span> <span class="n">precip_path</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">precip_path</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">actual_prec_zonal</span> <span class="o">=</span> <span class="n">zonal_stats</span><span class="p">(</span><span class="n">crops_path</span><span class="p">,</span>
                                            <span class="n">precip_path</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
                <span class="n">actual_precip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">actual_prec_zonal</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;median&quot;</span><span class="p">]</span> <span class="k">for</span>
                                    <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">actual_prec_zonal</span><span class="p">))])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actual_precip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precip_const</span>

            <span class="c1"># IF</span>
            <span class="n">intercept_factor</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">interceptFactor</span><span class="p">(</span><span class="n">df_dw_lai_all</span><span class="p">[</span><span class="s2">&quot;LAI&quot;</span><span class="p">],</span>
                                                  <span class="n">actual_precip</span><span class="p">,</span>
                                                  <span class="n">df_dw_lai_all</span><span class="p">[</span><span class="s2">&quot;dw_act&quot;</span><span class="p">],</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">coef_k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_S</span><span class="p">)</span>
            <span class="n">intercept_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ref_levels</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="n">intercept_factor</span><span class="p">)</span>

            <span class="c1"># Soil contamination</span>
            <span class="n">reduced_cont</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">contSoil</span><span class="p">(</span><span class="n">total_deposition</span><span class="p">,</span> <span class="n">intercept_factor</span><span class="p">)</span>
            <span class="n">reduced_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">reduced_cont</span><span class="p">)</span>
            <span class="n">reduced_cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">reduced_cont</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">reduced_cont</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">reduced_cont</span> <span class="o">=</span> <span class="n">total_deposition</span>

        <span class="c1"># Add reduced radioactive contamination amount to df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="p">[</span><span class="s2">&quot;Depo_red&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reduced_cont</span></div>

<div class="viewcode-block" id="RadAgro.readGrowthModelParams"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readGrowthModelParams">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readGrowthModelParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read data from growth model table and add it to df&quot;&quot;&quot;</span>

        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="n">model_IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">model_sowing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">dayOfYear</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">model_harvest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">dayOfYear</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">model_DWmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">model_LAImax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">model_R_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">model_R_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">model_coef_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">model_coef_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">df_growth_model_params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s2">&quot;ID_set&quot;</span><span class="p">:</span><span class="n">model_IDs</span><span class="p">,</span> <span class="s2">&quot;sow&quot;</span><span class="p">:</span><span class="n">model_sowing</span><span class="p">,</span>
            <span class="s2">&quot;harv&quot;</span><span class="p">:</span><span class="n">model_harvest</span><span class="p">,</span> <span class="s2">&quot;DW_max&quot;</span><span class="p">:</span><span class="n">model_DWmax</span><span class="p">,</span>
            <span class="s2">&quot;LAI_max&quot;</span><span class="p">:</span><span class="n">model_LAImax</span><span class="p">,</span> <span class="s2">&quot;R_max&quot;</span><span class="p">:</span><span class="n">model_R_max</span><span class="p">,</span>
            <span class="s2">&quot;R_min&quot;</span><span class="p">:</span><span class="n">model_R_min</span><span class="p">,</span> <span class="s2">&quot;coef_m&quot;</span><span class="p">:</span><span class="n">model_coef_m</span><span class="p">,</span>
            <span class="s2">&quot;coef_n&quot;</span><span class="p">:</span><span class="n">model_coef_n</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">df_growth_model_params</span></div>

<div class="viewcode-block" id="RadAgro.readCropsRotation"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readCropsRotation">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readCropsRotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get data from UI for crops rotation and their preparation</span>
<span class="sd">        for next calculation&quot;&quot;&quot;</span>

        <span class="c1"># No of counts in table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_sowing</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Read data</span>
        <span class="n">rotation_IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_sowing</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">crops_sowing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_sowing</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">crops_harvest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_sowing</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Create dataframe from the data</span>
        <span class="n">df_crops_rotation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:</span><span class="n">rotation_IDs</span><span class="p">,</span>
                                          <span class="s2">&quot;sow&quot;</span><span class="p">:</span><span class="n">crops_sowing</span><span class="p">,</span>
                                          <span class="s2">&quot;harv&quot;</span><span class="p">:</span><span class="n">crops_harvest</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">df_crops_rotation</span></div>

<div class="viewcode-block" id="RadAgro.readTransferCoef"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readTransferCoef">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readTransferCoef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reading transfer coefficient table fro UI&quot;&quot;&quot;</span>

        <span class="c1"># Calculate no. of rows</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Read data</span>
        <span class="n">IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span>
                        <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">transf_coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span>
                        <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                        <span class="nb">float</span><span class="p">)</span>

        <span class="c1"># Create dataframe from the data</span>
        <span class="n">df_transf_coefs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:</span> <span class="n">IDs</span><span class="p">,</span>
                                          <span class="s2">&quot;TK&quot;</span><span class="p">:</span> <span class="n">transf_coefs</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">df_transf_coefs</span></div>

<div class="viewcode-block" id="RadAgro.readMeadowsCut"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readMeadowsCut">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readMeadowsCut</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get data from UI for meadows mowing and their preparation</span>
<span class="sd">        for next calculation&quot;&quot;&quot;</span>

        <span class="c1"># No of columns in table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_meadow</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># In case of IDs, the values are increased to 100+ because</span>
        <span class="c1"># the resolution of the meadows cuts in TS</span>
        <span class="n">meadows_IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_meadow</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                               <span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">+</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                                <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">meadows_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_meadow</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                                <span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                                 <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Start of meadows growing after mowing. Start in spring is</span>
        <span class="c1"># 1th March</span>
        <span class="n">meadows_sowing</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">meadows_IDs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">meadows_sowing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meadows_cut</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">df_meadows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:</span><span class="n">meadows_IDs</span><span class="p">,</span>
                                          <span class="s2">&quot;sow&quot;</span><span class="p">:</span><span class="n">meadows_sowing</span><span class="p">,</span>
                                          <span class="s2">&quot;harv&quot;</span><span class="p">:</span><span class="n">meadows_cut</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">df_meadows</span></div>

<div class="viewcode-block" id="RadAgro.createCropsRotationTS"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.createCropsRotationTS">[dokumentace]</a>    <span class="k">def</span> <span class="nf">createCropsRotationTS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_crops_init</span><span class="p">,</span> <span class="n">df_crops_rotation</span><span class="p">,</span>
                              <span class="n">df_meadows</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create time series for crops and meadows rotation for the</span>
<span class="sd">        area of interest.</span>

<span class="sd">        :param df_crops_init: Initial dataframe for crops</span>
<span class="sd">        :param df_crops_rotation: Dataframe with crops rotation</span>
<span class="sd">        :param df_meadows: Dataframe with rotation of meadows mowing</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create table for writing data</span>
        <span class="n">df_rotation_init</span> <span class="o">=</span> <span class="n">df_crops_init</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create df for all crops in the crops rotation</span>
        <span class="n">df_crops_rot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">predictCropsRotation</span><span class="p">(</span><span class="n">df_crops_rotation</span><span class="p">,</span>
                            <span class="n">ID_col_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sowing_col_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">harvest_col_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">predict_months</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">,</span>
                            <span class="n">start_month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span>
                            <span class="n">early_stage_mng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early</span><span class="p">)</span>

        <span class="c1"># Create df for mowing meadows</span>
        <span class="n">df_meadows_rot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">predictCropsRotation</span><span class="p">(</span><span class="n">df_meadows</span><span class="p">,</span>
                            <span class="n">ID_col_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sowing_col_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">harvest_col_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">predict_months</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">,</span>
                            <span class="n">start_month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span>
                            <span class="n">early_stage_mng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early</span><span class="p">)</span>

        <span class="c1"># Change ID of the meadows TS to 20 (set in data as meadows)</span>
        <span class="n">df_meadows_rot</span><span class="p">[</span><span class="s2">&quot;ID_set&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">df_meadows_rot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_meadows_rot</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">df_meadows_rot</span><span class="p">[</span><span class="n">df_meadows_rot</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>

        <span class="c1"># Merge crops and meadows data together</span>
        <span class="n">df_all_crops</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_crops_rot</span><span class="p">,</span> <span class="n">df_meadows_rot</span><span class="p">],</span>
                                 <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Merge TS to vector data layer for whole area of interest</span>
        <span class="n">df_crops_rotation_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_rotation_init</span><span class="p">,</span>
                                          <span class="n">df_all_crops</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                          <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID_set&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_crops_rotation_all</span></div>

<div class="viewcode-block" id="RadAgro.createCropsHarvestTS"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.createCropsHarvestTS">[dokumentace]</a>    <span class="k">def</span> <span class="nf">createCropsHarvestTS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_crops_init</span><span class="p">,</span> <span class="n">df_crops_rotation</span><span class="p">,</span>
                             <span class="n">df_meadows</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create time series of the harvest time for the area of</span>
<span class="sd">        interest</span>
<span class="sd">        :param df_meadows: Dataframe with meadows mowing time series</span>
<span class="sd">        :param df_crops_rotation: Dataframe with crops rotation time</span>
<span class="sd">        series</span>
<span class="sd">        :param df_crops_init: Initial crops rotation dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create tables for writing data</span>
        <span class="n">df_harvest_init</span> <span class="o">=</span> <span class="n">df_crops_init</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create df for all crops in the crops rotation</span>
        <span class="n">df_crops_harvest</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">predictHarvest</span><span class="p">(</span><span class="n">df_crops_rotation</span><span class="p">,</span>
                            <span class="n">ID_col_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sowing_col_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">harvest_col_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">predict_months</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">,</span>
                            <span class="n">start_month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span>
                            <span class="n">early_stage_mng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early</span><span class="p">)</span>

        <span class="c1"># Create df for mowing meadows</span>
        <span class="n">df_meadows_harvest</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">predictHarvest</span><span class="p">(</span><span class="n">df_meadows</span><span class="p">,</span>
                            <span class="n">ID_col_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sowing_col_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">harvest_col_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">predict_months</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">,</span>
                            <span class="n">start_month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span>
                            <span class="n">early_stage_mng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early</span><span class="p">)</span>

        <span class="c1"># Change ID of the meadows TS to 20 (set in data as meadows)</span>
        <span class="n">df_meadows_harvest</span><span class="p">[</span><span class="s2">&quot;ID_set&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">df_meadows_harvest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_meadows_harvest</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Merge crops and meadows data together</span>
        <span class="n">df_all_harvest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_crops_harvest</span><span class="p">,</span>
                                    <span class="n">df_meadows_harvest</span><span class="p">],</span>
                                    <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Merge TS to vector data layer for whole area of interest</span>
        <span class="n">df_crops_harvest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_harvest_init</span><span class="p">,</span>
                                         <span class="n">df_all_harvest</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                         <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID_set&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_crops_harvest</span></div>

<div class="viewcode-block" id="RadAgro.createDryMassTS"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.createDryMassTS">[dokumentace]</a>    <span class="k">def</span> <span class="nf">createDryMassTS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_crops_init</span><span class="p">,</span> <span class="n">df_growth_model_params</span><span class="p">,</span>
                        <span class="n">df_crops_rotation</span><span class="p">,</span> <span class="n">df_meadows</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create time series table for dry weight of the crops for</span>
<span class="sd">        the area of interest</span>
<span class="sd">        </span>
<span class="sd">        :param df_meadows: Dataframe with meadows mowing time series</span>
<span class="sd">        :param df_crops_rotation: Dataframe with crops rotation time</span>
<span class="sd">            series</span>
<span class="sd">        :param df_growth_model_params: Dataframe with parameters of</span>
<span class="sd">            growth model</span>
<span class="sd">        :param df_crops_init: Initial crops rotation time series</span>
<span class="sd">            dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create table for writing data</span>
        <span class="n">df_dw_init</span> <span class="o">=</span> <span class="n">df_crops_init</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create df for all crops in the crops rotation</span>
        <span class="n">df_crops_dw</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">predictDryMass</span><span class="p">(</span><span class="n">df_crops_rotation</span><span class="p">,</span>
                                             <span class="n">df_growth_model_params</span><span class="p">,</span>
                                             <span class="n">ID_col_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                             <span class="n">sowing_col_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">harvest_col_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                             <span class="n">predict_months</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">,</span>
                                             <span class="n">start_month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span>
                                             <span class="n">early_stage_mng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early</span><span class="p">)</span>

        <span class="c1"># Create df for mowing meadows</span>
        <span class="n">df_meadows_dw</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">predictDryMass</span><span class="p">(</span><span class="n">df_meadows</span><span class="p">,</span>
                                               <span class="n">df_growth_model_params</span><span class="p">,</span>
                                               <span class="n">ID_col_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                               <span class="n">sowing_col_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                               <span class="n">harvest_col_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                               <span class="n">predict_months</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">,</span>
                                               <span class="n">start_month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_month</span><span class="p">,</span>
                                               <span class="n">early_stage_mng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early</span><span class="p">)</span>

        <span class="c1"># Change ID of the meadows TS to 20 (set in data as meadows)</span>
        <span class="n">df_meadows_dw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ID_set&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">df_meadows_dw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_meadows_dw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># Merge crops and meadows data together</span>
        <span class="n">df_all_dw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_crops_dw</span><span class="p">,</span> <span class="n">df_meadows_dw</span><span class="p">],</span>
                              <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Merge TS to vector data layer for whole area of interest</span>
        <span class="n">df_crops_dw_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_dw_init</span><span class="p">,</span> <span class="n">df_all_dw</span><span class="p">,</span>
                                        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID_set&#39;</span><span class="p">,</span>
                                        <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_crops_dw_all</span></div>

<div class="viewcode-block" id="RadAgro.readRFactorPercTable"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readRFactorPercTable">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readRFactorPercTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read table with percentage of R factor throughout the</span>
<span class="sd">        year.&quot;&quot;&quot;</span>

        <span class="c1"># Read number of columns in table</span>
        <span class="n">n_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_r_factor_perc</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span>

        <span class="n">r_perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_r_factor_perc</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">r_perc</span></div>

<div class="viewcode-block" id="RadAgro.readKFactorTable"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readKFactorTable">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readKFactorTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read R factors values of USLE equation corresponding to Main</span>
<span class="sd">        Soil Units (MSU) according to Janeček et al. 2007. The first</span>
<span class="sd">        column of output is MSU, the second is K factor of USLE</span>
<span class="sd">        equation.&quot;&quot;&quot;</span>

        <span class="c1"># No of counts in table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Read data</span>
        <span class="n">su_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">k_factor_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span>
                        <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                        <span class="nb">float</span><span class="p">)</span>

        <span class="n">df_k_factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;MSU&quot;</span><span class="p">:</span><span class="n">su_values</span><span class="p">,</span>
                                         <span class="s2">&quot;K_factor&quot;</span><span class="p">:</span><span class="n">k_factor_values</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">df_k_factor</span></div>

<div class="viewcode-block" id="RadAgro.readCFactorTable"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readCFactorTable">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readCFactorTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read C factors values of USLE equation corresponding to</span>
<span class="sd">        particular crops according to Janeček et al. 2007. The first</span>
<span class="sd">        column of output is crop ID, the second is C factor of USLE</span>
<span class="sd">        equation.&quot;&quot;&quot;</span>

        <span class="c1"># No of counts in table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Read data</span>
        <span class="n">crops_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">c_factor_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span>
                <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">df_c_factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:</span> <span class="n">crops_values</span><span class="p">,</span>
                                         <span class="s2">&quot;C_factor&quot;</span><span class="p">:</span> <span class="n">c_factor_values</span><span class="p">})</span>

        <span class="c1"># Add values for bare soil</span>
        <span class="n">df_bare_soil</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:[</span><span class="o">-</span><span class="mi">999</span><span class="p">],</span> <span class="s2">&quot;C_factor&quot;</span><span class="p">:[</span><span class="mf">0.9</span><span class="p">]})</span>

        <span class="n">df_c_factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_c_factor</span><span class="p">,</span> <span class="n">df_bare_soil</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_c_factor</span></div>

<div class="viewcode-block" id="RadAgro.calculateRadioactiveContamination"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.calculateRadioactiveContamination">[dokumentace]</a>    <span class="k">def</span> <span class="nf">calculateRadioactiveContamination</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_transf_coefs</span><span class="p">,</span>
                                          <span class="n">df_crops_rotation_all</span><span class="p">,</span>
                                          <span class="n">df_crops_harvest</span><span class="p">,</span>
                                          <span class="n">df_crops_dw_all</span><span class="p">,</span> <span class="n">k_factor</span><span class="p">,</span>
                                          <span class="n">ls_factor</span><span class="p">,</span> <span class="n">c_factor_tab</span><span class="p">,</span>
                                          <span class="n">r_perc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculation of total radioactive contamination of</span>
<span class="sd">        particular fields</span>

<span class="sd">        :param df_transf_coefs: Dataframe with transfer coefficient</span>
<span class="sd">            extracted from UI</span>
<span class="sd">        :param df_crops_rotation_all: Dataframe with crops rotation</span>
<span class="sd">            time series</span>
<span class="sd">        :param df_crops_harvest: Dataframe with harvests time series</span>
<span class="sd">        :param df_crops_dw_all: Dataframe with dry weight of biomass</span>
<span class="sd">            time series</span>
<span class="sd">        :param k_factor: Dataframe with K factor of USLE values</span>
<span class="sd">        :param ls_factor: Dataframe with LS factor of USLE values</span>
<span class="sd">        :param c_factor_tab: Dataframe with C factor of USLE values</span>
<span class="sd">        :param r_perc: Percentage of R factor during the year</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Calculation cycle of total radioactive contamination (RC) for</span>
        <span class="c1"># prediction time series</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_no_months</span><span class="p">):</span>
            <span class="c1"># Month name</span>
            <span class="n">month_name</span> <span class="o">=</span> <span class="s2">&quot;M</span><span class="si">{no}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">no</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

            <span class="c1"># Extraction of current month number</span>
            <span class="n">acc_day</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accident_date</span><span class="p">)</span>
            <span class="n">current_date</span> <span class="o">=</span> <span class="n">acc_day</span><span class="o">.</span><span class="n">addMonths</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">current_month</span> <span class="o">=</span> <span class="n">current_date</span><span class="o">.</span><span class="n">month</span><span class="p">()</span>

            <span class="c1"># 1. Read RC from previous month</span>
            <span class="n">radio_cont_tot_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">])</span>

            <span class="c1"># 2. Read column for harvest</span>
            <span class="n">harvest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_crops_harvest</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span>
            <span class="n">harvest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">harvest</span><span class="p">)</span>

            <span class="c1"># 3. Read dry mass of crops</span>
            <span class="n">dry_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_crops_dw_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span>
            <span class="n">dry_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">dry_mass</span><span class="p">)</span>

            <span class="c1"># 4. Merge Tk to actual crops</span>
            <span class="n">crops_act</span> <span class="o">=</span> <span class="n">df_crops_rotation_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">crops_act</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;ID_set&quot;</span><span class="p">:</span><span class="n">crops_act</span><span class="p">})</span>
            <span class="n">df_transf_coefs_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">crops_act</span><span class="p">,</span>
                                           <span class="n">df_transf_coefs</span><span class="p">,</span>
                                           <span class="n">on</span><span class="o">=</span><span class="s2">&quot;ID_set&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="n">tr_coefs_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_transf_coefs_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">tr_coefs_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">tr_coefs_arr</span><span class="p">)</span>

            <span class="c1"># 5. Calculation of radioactive contamination reduced by</span>
            <span class="c1"># crops biomass removing</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">radio_cont_tot_init</span> <span class="o">-</span> <span class="n">radio_cont_tot_init</span>\
                             <span class="o">*</span> <span class="n">dry_mass</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">tr_coefs_arr</span> <span class="o">*</span> <span class="n">harvest</span>

            <span class="c1"># 6. Apply reference levels - combine RLs with new values</span>
            <span class="n">ref_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_ref_levels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ref_levels</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span>
                                      <span class="n">radio_cont_tot_init</span><span class="p">,</span>
                                      <span class="n">radio_cont_tot</span><span class="p">)</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">radio_cont_tot</span><span class="p">)</span>

            <span class="c1"># 7. Hydrology - reducing radioactivity by outflow of</span>
            <span class="c1"># TODO: doplnit celou hydrologii</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">radio_cont_tot</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>     <span class="c1"># TODO</span>

            <span class="c1"># 8. Erosion - reducing radioactive contamination by</span>
            <span class="c1"># erosion</span>
            <span class="c1"># R factor</span>
            <span class="n">r_factor</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">fR</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_factor_const</span><span class="p">,</span> <span class="n">r_perc</span><span class="p">[</span><span class="n">current_month</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># C factor</span>
            <span class="n">c_factor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">crops_act</span><span class="p">,</span> <span class="n">c_factor_tab</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                                <span class="n">on</span><span class="o">=</span><span class="s2">&quot;ID_set&quot;</span><span class="p">)</span>

            <span class="c1"># Water erosion in t/ha/month</span>
            <span class="n">usle_all</span> <span class="o">=</span> <span class="n">r_factor</span> <span class="o">*</span> <span class="n">ls_factor</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>\
                    <span class="o">*</span> <span class="n">k_factor</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_factor</span><span class="p">[</span><span class="s2">&quot;C_factor&quot;</span><span class="p">]</span> <span class="o">*</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">p_factor</span>

            <span class="c1"># USLE for reference level 3</span>
            <span class="n">usle_r3</span> <span class="o">=</span> <span class="n">r_factor</span> <span class="o">*</span> <span class="n">ls_factor</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span>
                                 <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">k_factor</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span>

            <span class="n">usle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ref_levels</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="n">usle_r3</span><span class="p">,</span> <span class="n">usle_all</span><span class="p">)</span>

            <span class="c1"># Dry soil mas for mixture layer (ca 0.2 m; kg)</span>
            <span class="n">soil_mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">soil_depth</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">soil_vol_mass</span>

            <span class="c1"># Activity released by water erosion</span>
            <span class="n">radio_usle</span> <span class="o">=</span> <span class="n">radio_cont_tot</span> <span class="o">*</span> <span class="n">usle</span> <span class="o">*</span> <span class="mf">0.1</span><span class="o">/</span><span class="n">soil_mass</span>

            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">radio_cont_tot</span> <span class="o">-</span> <span class="n">radio_usle</span>

            <span class="c1"># 9. Radioactive decay</span>
            <span class="c1"># Replace nans in RC by init RC</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">radio_cont_tot</span><span class="p">)</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">radio_cont_tot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="n">radio_cont_tot_init</span><span class="p">,</span> <span class="n">radio_cont_tot</span><span class="p">)</span>

            <span class="c1"># Calculate radioactivity decay</span>
            <span class="n">radio_cont_tot</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">activityDecay</span><span class="p">(</span><span class="n">radio_cont_tot</span><span class="p">,</span>
                                              <span class="n">current_month</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">radionuclide</span><span class="p">)</span>

            <span class="c1"># 10. Add data to df with radioactive contamination</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="p">[</span><span class="n">month_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">radio_cont_tot</span>

            <span class="c1"># 11. Create new reference levels and add it to df</span>
            <span class="n">new_ref_levels</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">referLevel</span><span class="p">(</span><span class="n">radio_cont_tot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rl_1</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">rl_2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df_ref_levels</span><span class="p">[</span><span class="n">month_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_ref_levels</span></div>

    <span class="c1"># def exportTablesToCsv(self):</span>
    <span class="c1">#     &quot;&quot;&quot;Exporting tables created by RadAgro to csv&quot;&quot;&quot;</span>
    <span class="c1"># </span>
    <span class="c1">#     # TODO: zatim se budou data ukládat do /home, následně bude export do</span>
    <span class="c1">#     #  gdpg - všechny vrstvy do jedný databáze</span>
    <span class="c1"># </span>
    <span class="c1">#     self.df_radio_contamination.to_csv(&quot;kontam.csv&quot;)</span>
    <span class="c1">#     self.df_ref_levels.to_csv(&quot;RU.csv&quot;)</span>
    <span class="c1">#     df_crops_rotation_all.to_csv(&quot;OP.csv&quot;)</span>
    <span class="c1">#     self.df_crops_harvest.to_csv(&quot;Sklizne.csv&quot;)</span>
    <span class="c1">#     df_crops_dw_all.to_csv(&quot;susina.csv&quot;)</span>

<div class="viewcode-block" id="RadAgro.exportRadioCont2GeoPackage"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.exportRadioCont2GeoPackage">[dokumentace]</a>    <span class="k">def</span> <span class="nf">exportRadioCont2GeoPackage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Export dataframe with radioactive contamination to</span>
<span class="sd">        Geo Package (gpkg).&quot;&quot;&quot;</span>

        <span class="n">in_lyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="p">)</span>
        <span class="n">out_lyr_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">out_file</span><span class="o">.</span><span class="n">filePath</span><span class="p">()</span>

        <span class="n">joinLyrWithDataFrame</span><span class="p">(</span><span class="n">in_lyr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="p">,</span>
                             <span class="n">out_lyr_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.getLyrPath"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.getLyrPath">[dokumentace]</a>    <span class="k">def</span> <span class="nf">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comboBox</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get path to input file from combobox</span>

<span class="sd">        :param comboBox: combo box in UI.</span>
<span class="sd">        :retrun: path to input file&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">get_index</span> <span class="o">=</span> <span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
            <span class="n">get_path</span> <span class="o">=</span> <span class="n">comboBox</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span><span class="n">get_index</span><span class="p">)</span><span class="o">.</span><span class="n">source</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">get_path</span> <span class="o">=</span> <span class="n">comboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">get_path</span></div>

<span class="c1">#-----------------------------------------------------------------------</span>
<span class="c1"># UI manipulation</span>

<div class="viewcode-block" id="RadAgro.readIDField"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.readIDField">[dokumentace]</a>    <span class="k">def</span> <span class="nf">readIDField</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read  IDs for particular fileds in the area of interest</span>
<span class="sd">        and set the data to select_ID combobox for generating plots</span>
<span class="sd">        with reults&quot;&quot;&quot;</span>

        <span class="c1"># TODO: solve a shift of ID values 1 --&gt; 0 in case of shapefile</span>
        <span class="c1">#  without FID</span>

        <span class="c1"># Clear cbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Get data from vector file for ID field</span>
        <span class="n">map_lyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="o">.</span><span class="n">currentLayer</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">crop_ID_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">map_lyr</span><span class="o">.</span><span class="n">getFeatures</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crop_ID_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">id</span><span class="p">())</span>

        <span class="n">values_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crop_ID_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crop_ID_list</span><span class="p">))]</span>

        <span class="c1"># Set IDs to cbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">values_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Set completer for cbox</span>
        <span class="n">completer</span> <span class="o">=</span> <span class="n">QCompleter</span><span class="p">(</span><span class="n">values_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">setCompleter</span><span class="p">(</span><span class="n">completer</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.plot"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.plot">[dokumentace]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Create plot in the UI&quot;</span>

        <span class="c1"># TODO: vložit do grafu nástroje na analýzu a hodnocení grafu</span>

        <span class="c1"># Data</span>
        <span class="n">ignore_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

        <span class="c1"># Clear last figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Get position in the table</span>
            <span class="n">pl_ID_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">pl_ID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pl_ID_text</span><span class="p">)</span>

            <span class="c1"># get data for plotting from selected row (polygon)</span>
            <span class="n">y_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df_radio_contamination</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pl_ID</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y_row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">:]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">pl_ID_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_ID_select</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># with plt.xkcd():</span>
        <span class="c1"># create an axis</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>

        <span class="c1"># Axes names</span>
        <span class="n">x_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Čas (měs.)&quot;</span><span class="p">)</span>
        <span class="n">y_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Kontaminace $(Bq.m^{-2})$&quot;</span><span class="p">)</span>

        <span class="c1"># Axes labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_name</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_y_scale</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="c1"># Set number of ticks on x-axis</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                           <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

        <span class="c1"># plot data</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;ID plochy: </span><span class="si">{ID}</span><span class="s2">&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ID</span> <span class="o">=</span>
                                                                     <span class="n">pl_ID_text</span><span class="p">))</span>

        <span class="c1"># Legend position</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="c1"># Draw plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="RadAgro.fillParams"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.fillParams">[dokumentace]</a>    <span class="k">def</span> <span class="nf">fillParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Fill parameters of the model to tables&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fillGrowthModelTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fillCN</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fillCFactor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fillRadioTransferParams</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fillSoilUnits</span><span class="p">()</span>

        <span class="c1"># Set enabled OK dialog button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">button_box</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="RadAgro.fillSoilUnits"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.fillSoilUnits">[dokumentace]</a>    <span class="k">def</span> <span class="nf">fillSoilUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill soil parameters (Soil hydrological category and</span>
<span class="sd">        K-factor to table tw_HPJ_params&quot;&quot;&quot;</span>

        <span class="c1"># Read unique values of HPJ (Main Soil Units) from data</span>
        <span class="n">map_lyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ</span><span class="o">.</span><span class="n">currentLayer</span><span class="p">()</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ_key</span><span class="o">.</span><span class="n">currentField</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">map_lyr</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span>

        <span class="c1"># Extract unique vaues of HPJ from the layer</span>
        <span class="n">hpj_set</span> <span class="o">=</span> <span class="n">map_lyr</span><span class="o">.</span><span class="n">uniqueValues</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">hpj_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">hpj_set</span><span class="p">))</span>

        <span class="c1"># Read values from soil_hydr table</span>
        <span class="n">hps_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_hydr</span><span class="p">[</span><span class="s2">&quot;HPS&quot;</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hpj_list</span><span class="p">]</span>
        <span class="n">k_factor_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_hydr</span><span class="p">[</span><span class="s2">&quot;K_factor&quot;</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hpj_list</span><span class="p">]</span>

        <span class="c1"># Set No. of rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hpj_list</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hpj_list</span><span class="p">)):</span>
            <span class="c1"># Col. 0: HPJ</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">hpj_list</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># Col. 1: HPS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">hps_list</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># Col. 2: K factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_HPJ_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">k_factor_list</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span></div>

<div class="viewcode-block" id="RadAgro.fillRadioTransferParams"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.fillRadioTransferParams">[dokumentace]</a>    <span class="k">def</span> <span class="nf">fillRadioTransferParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill Radiotransfer parameters for particular crops to</span>
<span class="sd">        tw_radio_coefs table&quot;&quot;&quot;</span>

        <span class="c1"># Get number of rows in tw_crops_orig table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Get current values from tw_crops_orig table</span>
        <span class="n">crop_ind</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>

        <span class="c1"># Variables lists</span>
        <span class="n">crop_unique_ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">crop_ind</span><span class="p">)</span>
        <span class="n">crop_unique_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;crop&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_contaminant</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>   <span class="c1"># Cs</span>
            <span class="n">radio_coefs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;R_transf_Cs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>       <span class="c1"># Sr</span>
            <span class="n">radio_coefs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;R_transf_Sr&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>

        <span class="c1"># Set number of rows in table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">))</span>

        <span class="c1"># Set items</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">)):</span>
            <span class="c1"># col 1. ID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 2. crop names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_names</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 3. Radiotransfer coef.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_radio_coefs</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">radio_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span></div>

<div class="viewcode-block" id="RadAgro.fillCFactor"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.fillCFactor">[dokumentace]</a>    <span class="k">def</span> <span class="nf">fillCFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill C factor values to tw_C_factor table&quot;&quot;&quot;</span>

        <span class="c1"># Get number of rows in tw_crops_orig table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Get current values from tw_crops_orig table</span>
        <span class="n">crop_ind</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>

        <span class="c1"># Variables lists</span>
        <span class="n">crop_unique_ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">crop_ind</span><span class="p">)</span>
        <span class="n">crop_unique_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;crop&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">c_factor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;C_factor&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>

        <span class="c1"># Set number of rows in table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">))</span>

        <span class="c1"># Set items</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">)):</span>
            <span class="c1"># col 1. ID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 2. crop names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_names</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 3. C factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_C_factor</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">c_factor</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span></div>

<div class="viewcode-block" id="RadAgro.fillCN"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.fillCN">[dokumentace]</a>    <span class="k">def</span> <span class="nf">fillCN</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Fill CN curve numbers to tw_CN table&quot;</span>

        <span class="c1"># Get number of rows in tw_crops_orig table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Get current values from tw_crops_orig table</span>
        <span class="n">crop_ind</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>

        <span class="c1"># Variables lists</span>
        <span class="n">crop_unique_ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">crop_ind</span><span class="p">)</span>
        <span class="n">crop_unique_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;crop&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_AG</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_A_G&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_AB</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_A_B&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_BG</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_B_G&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_BB</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_B_B&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_CG</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_C_G&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_CB</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_C_B&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_DG</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_D_G&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">cn_DB</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;CN_D_B&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>

        <span class="c1"># Set number of rows in table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">))</span>

        <span class="c1"># Set items</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">)):</span>
            <span class="c1"># col 1. ID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 2. crop names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_names</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 3. CN AG</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_AG</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 4. CN AB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_AB</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 5. CN BG</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_BG</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 6. CN BB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_BB</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 7. CN CG</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_CG</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 8. CN CB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_CB</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 9. CN DG</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_DG</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 10. CN DB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_CN</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">cn_DB</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span></div>

<div class="viewcode-block" id="RadAgro.fillGrowthModelTable"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.fillGrowthModelTable">[dokumentace]</a>    <span class="k">def</span> <span class="nf">fillGrowthModelTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fill parameters of particular crops to the</span>
<span class="sd">        tw_growth_params table&quot;&quot;&quot;</span>

        <span class="c1"># Get number of rows in tw_crops_orig table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Get current values from tw_crops_orig table</span>
        <span class="n">crop_ind</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">cellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>

        <span class="c1"># Variables lists</span>
        <span class="n">crop_unique_ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">crop_ind</span><span class="p">)</span>
        <span class="n">crop_unique_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;crop&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">crop_dw_max</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;dw_max&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">crop_lai_max</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;LAI_max&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                        <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">crop_r_max</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;r_max&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>
        <span class="n">crop_r_min</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;r_min&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crop_unique_ID</span><span class="p">]</span>

        <span class="c1"># Set number of rows in table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">))</span>
        <span class="c1"># Set items</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">)):</span>
            <span class="c1"># col 1. ID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_ID</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 2. crop names</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_unique_names</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1">#col 3. Sowing date</span>
            <span class="n">date_sow_in</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;sowing&quot;</span><span class="p">][</span><span class="n">crop_unique_ID</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">date_edit_sow</span> <span class="o">=</span> <span class="n">QDateEdit</span><span class="p">()</span>
            <span class="n">date_edit_sow</span><span class="o">.</span><span class="n">setDisplayFormat</span><span class="p">(</span><span class="s2">&quot;dd.MM&quot;</span><span class="p">)</span>
            <span class="n">date_edit_sow</span><span class="o">.</span><span class="n">setDate</span><span class="p">(</span><span class="n">QDate</span><span class="p">(</span><span class="n">date_sow_in</span><span class="p">))</span>
            <span class="n">date_edit_sow</span><span class="o">.</span><span class="n">setCalendarPopup</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">date_edit_sow</span><span class="p">)</span>
            <span class="c1"># col 4. harvest date</span>
            <span class="n">date_harv_in</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;harvest&quot;</span><span class="p">][</span><span class="n">crop_unique_ID</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">date_edit_harv</span> <span class="o">=</span> <span class="n">QDateEdit</span><span class="p">()</span>
            <span class="n">date_edit_harv</span><span class="o">.</span><span class="n">setDisplayFormat</span><span class="p">(</span><span class="s2">&quot;dd.MM&quot;</span><span class="p">)</span>
            <span class="n">date_edit_harv</span><span class="o">.</span><span class="n">setDate</span><span class="p">(</span><span class="n">QDate</span><span class="p">(</span><span class="n">date_harv_in</span><span class="p">))</span>
            <span class="n">date_edit_harv</span><span class="o">.</span><span class="n">setCalendarPopup</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                                                    <span class="n">date_edit_harv</span><span class="p">)</span>
            <span class="c1"># col 5. Max dry mass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_dw_max</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 6. Max LAI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_lai_max</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 7. Max biomass moisture</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_r_max</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="c1"># col 8. Min biomass moisture</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">crop_r_min</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="c1"># col 9. coef. m and col 10 coef. n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculateGowthCurveCoefs</span><span class="p">()</span></div>

<div class="viewcode-block" id="RadAgro.calculateGowthCurveCoefs"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.calculateGowthCurveCoefs">[dokumentace]</a>    <span class="k">def</span> <span class="nf">calculateGowthCurveCoefs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate default coefficients (slope and intercept of</span>
<span class="sd">        growth curves for the particular crops and add them to the</span>
<span class="sd">        tw_growth_params table&quot;&quot;&quot;</span>

        <span class="c1"># Get number of rows in the table</span>
        <span class="n">r_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="c1"># Read dry mass values from the table</span>
        <span class="n">dw_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">)]</span>

        <span class="c1"># Calculate slopes and intercepts of growth models for crops</span>
        <span class="c1"># and set it to table</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_count</span><span class="p">):</span>
            <span class="n">coef_m</span><span class="p">,</span> <span class="n">coef_n</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">calculateGrowthCoefs</span><span class="p">(</span><span class="n">dw_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="c1"># col 9. coef. m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">coef_m</span><span class="p">,</span> <span class="mi">3</span><span class="p">))))</span>
            <span class="c1"># col 10. coef. n</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_growth_params</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">coef_n</span><span class="p">,</span> <span class="mi">3</span><span class="p">))))</span></div>

<div class="viewcode-block" id="RadAgro.setClimateTable"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.setClimateTable">[dokumentace]</a>    <span class="k">def</span> <span class="nf">setClimateTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set soil saturation state in form of cboxes to table&quot;&quot;&quot;</span>

        <span class="c1"># Get row counts:</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_climate</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>

        <span class="c1"># Add cboxes to table</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row_count</span><span class="p">):</span>
            <span class="c1"># create cboxes</span>
            <span class="n">combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_sat</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="c1"># add cboxes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_climate</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">combo</span><span class="p">)</span>
            <span class="c1"># Set doublespinboxes for settings monthly mean temperature</span>
            <span class="c1"># and precipitation</span>
            <span class="n">spin_temperature</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
            <span class="n">spin_temperature</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mf">50.0</span><span class="p">)</span>
            <span class="n">spin_precip</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_climate</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">spin_temperature</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_climate</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">spin_precip</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.tableRemoveRow"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.tableRemoveRow">[dokumentace]</a>    <span class="k">def</span> <span class="nf">tableRemoveRow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove row from table&quot;&quot;&quot;</span>

        <span class="c1"># Get row counts:</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="n">row_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.meadowTableAddRow"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.meadowTableAddRow">[dokumentace]</a>    <span class="k">def</span> <span class="nf">meadowTableAddRow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add rows with meadows mowing and month of harvest to the</span>
<span class="sd">        table for the area of</span>
<span class="sd">        interest.</span>

<span class="sd">        :param table: Table of meadows mowing from UI (QTableWidget).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set column witdth</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

        <span class="c1"># Get row counts:</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">cuts_list</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;První seč&quot;</span><span class="p">),</span>
                     <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Druhá seč&quot;</span><span class="p">),</span>
                     <span class="mi">2</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Třetí seč&quot;</span><span class="p">)}</span>

        <span class="c1"># Months list</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

        <span class="c1"># Set new row</span>
        <span class="k">if</span> <span class="n">row_count</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="n">row_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add cboxes and dateEdit boxes to tw_sowing table</span>
        <span class="c1"># create cboxes</span>
        <span class="n">combo_crops</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">combo_crops</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">cuts_list</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="c1"># Create date cboxes</span>
        <span class="n">combo_har</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">combo_har</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
        <span class="c1"># add cboxes to table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">combo_crops</span><span class="p">)</span>
        <span class="c1"># add date edit widgets to table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">combo_har</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.cropTableAddRow"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.cropTableAddRow">[dokumentace]</a>    <span class="k">def</span> <span class="nf">cropTableAddRow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add row with crops and terms of sowing and harvest to</span>
<span class="sd">        sowing procedure table for the area of interest.</span>

<span class="sd">        :param table: Table of crops rotation with sowing and harvest</span>
<span class="sd">            terms (QTableWidget).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Set column witdth</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

        <span class="c1"># Get row counts:</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="n">crops_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;crop&quot;</span><span class="p">])</span>

        <span class="c1"># Months list</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

        <span class="c1"># Set new row</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="n">row_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add cboxes and dateEdit boxes to tw_sowing table</span>
        <span class="c1"># create cboxes</span>
        <span class="n">combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">crops_list</span><span class="p">)</span>
        <span class="c1"># Create date edit boxes</span>
        <span class="n">combo_sow</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">combo_sow</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
        <span class="n">combo_har</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">combo_har</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
        <span class="c1"># add cboxes to table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">combo</span><span class="p">)</span>
        <span class="c1"># add date edit widgets to table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">combo_sow</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">row_count</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">combo_har</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.setOrigCropsToTable"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.setOrigCropsToTable">[dokumentace]</a>    <span class="k">def</span> <span class="nf">setOrigCropsToTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set crops from crop field defined by user to table</span>
<span class="sd">        and select corresponding crops from list&quot;&quot;&quot;</span>

        <span class="n">map_lyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="o">.</span><span class="n">currentLayer</span><span class="p">()</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr_key</span><span class="o">.</span><span class="n">currentField</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">map_lyr</span><span class="o">.</span><span class="n">fields</span><span class="p">()</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="n">values_set</span> <span class="o">=</span> <span class="n">map_lyr</span><span class="o">.</span><span class="n">uniqueValues</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">crops_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crops</span><span class="p">[</span><span class="s2">&quot;crop&quot;</span><span class="p">])</span>

        <span class="c1"># Fill first table</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values_set</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values_set</span><span class="p">))</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">values_set</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># Add cboxes to second table</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values_set</span><span class="p">)):</span>
                <span class="c1"># Create cbox</span>
                <span class="n">combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
                <span class="n">combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">crops_list</span><span class="p">)</span>
                <span class="c1"># add cbox to table</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tw_crops_orig</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">combo</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Chyba&quot;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Nelze načíst hodnoty do tabulky, seznam je &quot;</span>
                        <span class="s2">&quot;příliš dlouhý.&quot;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.constants"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.constants">[dokumentace]</a>    <span class="k">def</span> <span class="nf">constants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Some constants used in the program&quot;&quot;&quot;</span>

        <span class="c1"># Read crops to pd.DataFrame</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">==</span> <span class="s2">&quot;cs&quot;</span><span class="p">:</span>
            <span class="n">crops_params_table</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
                                              <span class="s2">&quot;params/crops_params_cs.csv&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">crops_params_table</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
                                              <span class="s2">&quot;params/crops_params_en.csv&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">crops</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">crops_params_table</span><span class="p">)</span>

        <span class="c1"># Read Main soil units (HPJ) and hydrological soil groups</span>
        <span class="n">soil_hps_table</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span>
                                      <span class="s2">&quot;params/Soil_hydr_cat.csv&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_hydr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">soil_hps_table</span><span class="p">)</span>

        <span class="c1"># The state of soil saturation by soil water: good (Do) or</span>
        <span class="c1"># bad (Šp)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_sat</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Dobré&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Špatné&quot;</span><span class="p">)}</span></div>

<div class="viewcode-block" id="RadAgro.setKeyField"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.setKeyField">[dokumentace]</a>    <span class="k">def</span> <span class="nf">setKeyField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comboBox_in</span><span class="p">,</span> <span class="n">comboBox_out</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set variables from the map_lyr.</span>

<span class="sd">        :param comboBox_in: Combo box (QgsMapLayerComboBox) with vector</span>
<span class="sd">            layer.</span>
<span class="sd">        :param comboBox_out: Fields of vector layer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">map_lyr</span> <span class="o">=</span> <span class="n">comboBox_in</span><span class="o">.</span><span class="n">currentLayer</span><span class="p">()</span>
        <span class="n">comboBox_out</span><span class="o">.</span><span class="n">setLayer</span><span class="p">(</span><span class="n">map_lyr</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.reset"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.reset">[dokumentace]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset all settings in the UI&quot;&quot;&quot;</span>
        <span class="c1"># TODO: je potreba prodiskutovat jestli jo nebo ne. Zatim ne</span>

        <span class="c1"># # Set zero</span>
        <span class="c1"># self.dlg.cbox_rad_depo.setCurrentIndex(0)</span>
        <span class="c1"># self.dlg.cbox_precip.setCurrentIndex(0)</span>
        <span class="c1"># self.dlg.cbox_dmt.setCurrentIndex(0)</span>
        <span class="c1"># self.dlg.cbox_HPJ.setCurrentIndex(0)</span>
        <span class="c1"># self.dlg.cbox_crop_lyr.setCurrentIndex(0)</span>
        <span class="c1"># self.dlg.tw_sowing.setRowCount(0)</span>

        <span class="c1"># Remove tmp folder</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp_folder</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.showInfo"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.showInfo">[dokumentace]</a>    <span class="k">def</span> <span class="nf">showInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create infobox with acknowledgement. The infobox is shown</span>
<span class="sd">        during the start of the plugin.&quot;&quot;&quot;</span>

        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;figs&quot;</span><span class="p">,</span> <span class="s2">&quot;symbols&quot;</span><span class="p">,</span> <span class="s2">&quot;MV_CR2.png&quot;</span><span class="p">)</span>

        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span>
                                            <span class="n">Qt</span><span class="o">.</span><span class="n">SmoothTransformation</span><span class="p">)</span>

        <span class="n">msgBox</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="n">msgBox</span><span class="o">.</span><span class="n">setIconPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
        <span class="n">msgBox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Vývoj programu RadAgro for QGIS byl &quot;</span>
                               <span class="s2">&quot;podpořen z projektu Ministerstva &quot;</span>
                               <span class="s2">&quot;vnitra České republiky VI20172020098&quot;</span><span class="p">))</span>
        <span class="n">msgBox</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Vítejte v programu RadAgro!&quot;</span><span class="p">))</span>
        <span class="n">msgBox</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span></div>

<div class="viewcode-block" id="RadAgro.pluginHelp"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.pluginHelp">[dokumentace]</a>    <span class="k">def</span> <span class="nf">pluginHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the help file.&quot;&quot;&quot;</span>
        <span class="n">help_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dir</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;build&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="s2">&quot;index.html&quot;</span><span class="p">)</span>
        <span class="n">help_file_norm</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">help_file</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">!=</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span>
                <span class="n">QDesktopServices</span><span class="o">.</span><span class="n">openUrl</span><span class="p">(</span><span class="n">QUrl</span><span class="p">(</span><span class="n">help_file_norm</span><span class="p">,</span>
                                              <span class="n">QUrl</span><span class="o">.</span><span class="n">TolerantMode</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">help_file</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">help_file_norm</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">help_file_norm</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Varování&quot;</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Jejda, nápovědu nelze otevřít...&quot;</span><span class="p">),</span>
                                                <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.setCboxEmpty"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.setCboxEmpty">[dokumentace]</a>    <span class="k">def</span> <span class="nf">setCboxEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comboBox</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setting of empty value (text) in comboBoxes.&quot;&quot;&quot;</span>

        <span class="n">comboBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.loadResults"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.loadResults">[dokumentace]</a>    <span class="k">def</span> <span class="nf">loadResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load calculated vector layer of radioactive deposition</span>
<span class="sd">        time development.&quot;&quot;&quot;</span>

        <span class="c1"># Get path to output</span>
        <span class="n">out_lyr_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">out_file</span><span class="o">.</span><span class="n">filePath</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">addVectorLayer</span><span class="p">(</span><span class="n">out_lyr_path</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ogr&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">clearWidgets</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Varování&quot;</span><span class="p">),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Jejda, vrstva nebyla načtena...&quot;</span><span class="p">),</span>
                                                    <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Warning</span><span class="p">,</span>
                                                    <span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.startWorker"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.startWorker">[dokumentace]</a>    <span class="k">def</span> <span class="nf">startWorker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start threads with calculation process and with progress</span>
<span class="sd">        bar.&quot;&quot;&quot;</span>

        <span class="c1"># create a new worker instance</span>
        <span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_HPJ</span><span class="p">),</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">su_field</span><span class="p">,</span>
         <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLyrPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">cbox_crop_lyr</span><span class="p">),</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">loadRasters</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">createCropsInitDf</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readGrowthModelParams</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readTransferCoef</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">earlyStage</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readCropsRotation</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readMeadowsCut</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">createCropsRotationTS</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">createCropsHarvestTS</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">createDryMassTS</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readKFactorTable</span><span class="p">,</span>
         <span class="n">ru</span><span class="o">.</span><span class="n">fK</span><span class="p">,</span>
         <span class="n">ru</span><span class="o">.</span><span class="n">fLS</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readCFactorTable</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">readRFactorPercTable</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">calculateRadioactiveContamination</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">exportRadioCont2GeoPackage</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_m</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_n</span><span class="p">)</span>

        <span class="c1"># configure the QgsMessageBar</span>
        <span class="n">messageBar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">createMessage</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Probíhá výpočet změn radioaktivní depozice:&quot;</span><span class="p">),</span> <span class="p">)</span>
        <span class="n">progressBar</span> <span class="o">=</span> <span class="n">QProgressBar</span><span class="p">()</span>
        <span class="n">progressBar</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">)</span>
        <span class="n">progressBar</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">progressBar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">cancelButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">()</span>
        <span class="n">cancelButton</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s1">&#39;Zrušit&#39;</span><span class="p">))</span>
        <span class="n">cancelButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">kill</span><span class="p">)</span>
        <span class="n">messageBar</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">progressBar</span><span class="p">)</span>
        <span class="n">messageBar</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">cancelButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushWidget</span><span class="p">(</span><span class="n">messageBar</span><span class="p">,</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageBar</span> <span class="o">=</span> <span class="n">messageBar</span>

        <span class="c1"># start the worker in a new thread</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">QThread</span><span class="p">()</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">moveToThread</span><span class="p">(</span><span class="n">thread</span><span class="p">)</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workerFinished</span><span class="p">)</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workerError</span><span class="p">)</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">progressBar</span><span class="o">.</span><span class="n">setValue</span><span class="p">)</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">progressBar</span><span class="o">.</span><span class="n">setFormat</span><span class="p">)</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">started</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span> <span class="o">=</span> <span class="n">thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">worker</span></div>

<div class="viewcode-block" id="RadAgro.workerFinished"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.workerFinished">[dokumentace]</a>    <span class="k">def</span> <span class="nf">workerFinished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activity after worker thread finishing.&quot;&quot;&quot;</span>

        <span class="c1"># clean up the worker and thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>

        <span class="c1"># The page with graph enabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># remove widget from message bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">popWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageBar</span><span class="p">)</span>
        <span class="c1"># Create finish message and load lyrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">clearWidgets</span><span class="p">()</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">createMessage</span><span class="p">(</span><span class="s2">&quot;Info&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span>
            <span class="s2">&quot;Výpočet byl dokončen. Přejete si načíst &quot;</span>
            <span class="s2">&quot;výslednou vrstvu časových změn radioaktivní &quot;</span>
            <span class="s2">&quot;kontaminace území do QGIS?&quot;</span><span class="p">))</span>
        <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Načíst výsledek&quot;</span><span class="p">))</span>
        <span class="n">button</span><span class="o">.</span><span class="n">pressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadResults</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">Qgis</span><span class="o">.</span><span class="n">Info</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadAgro.workerError"><a class="viewcode-back" href="../libs.html#RadAgro.RadAgro.workerError">[dokumentace]</a>    <span class="k">def</span> <span class="nf">workerError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Exceptins of worker thread running.&quot;&quot;&quot;</span>

        <span class="c1"># TODO - překlad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span>
            <span class="s2">&quot;Něco zlého se přihodilo!</span><span class="se">\n</span><span class="si">{ex_str}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ex_str</span><span class="o">=</span><span class="n">exception_string</span><span class="p">),</span>
            <span class="n">level</span><span class="o">=</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Critical</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Worker"><a class="viewcode-back" href="../libs.html#RadAgro.Worker">[dokumentace]</a><span class="k">class</span> <span class="nc">Worker</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Example worker for calculating the total area of all features</span>
<span class="sd">    in a layer&quot;&quot;&quot;</span>
    <span class="c1"># Threading was done due to:</span>
    <span class="c1"># https://snorfalorpagus.net/blog/2013/12/07/multithreading-in</span>
    <span class="c1"># -qgis-python-plugins/</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">suLyrPath</span><span class="p">,</span>
                 <span class="n">su_field</span><span class="p">,</span>
                 <span class="n">getCropsPath</span><span class="p">,</span>
                 <span class="n">loadRasters</span><span class="p">,</span>
                 <span class="n">createCropsDf</span><span class="p">,</span>
                 <span class="n">readGrowthModel</span><span class="p">,</span>
                 <span class="n">readTransfCoefs</span><span class="p">,</span>
                 <span class="n">earlyStage</span><span class="p">,</span>
                 <span class="n">readCropsRot</span><span class="p">,</span>
                 <span class="n">readMeadows</span><span class="p">,</span>
                 <span class="n">createCropsRot</span><span class="p">,</span>
                 <span class="n">createCropsHarvest</span><span class="p">,</span>
                 <span class="n">createDryMass</span><span class="p">,</span>
                 <span class="n">readKFactor</span><span class="p">,</span>
                 <span class="n">calcFK</span><span class="p">,</span>
                 <span class="n">calcFLS</span><span class="p">,</span>
                 <span class="n">readCTable</span><span class="p">,</span>
                 <span class="n">readRTable</span><span class="p">,</span>
                 <span class="n">calcRadioactiveCont</span><span class="p">,</span>
                 <span class="n">exportRadCont</span><span class="p">,</span>
                 <span class="n">ls_m</span><span class="p">,</span>
                 <span class="n">ls_n</span><span class="p">):</span>

        <span class="n">QThread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Read variables - calculation process can be done with</span>
        <span class="c1"># RadAgro.resultsCalculate method without threading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suLyrPath</span> <span class="o">=</span> <span class="n">suLyrPath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">su_field</span> <span class="o">=</span> <span class="n">su_field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getCropsPath</span> <span class="o">=</span> <span class="n">getCropsPath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadRasters</span> <span class="o">=</span> <span class="n">loadRasters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createCropsDf</span> <span class="o">=</span> <span class="n">createCropsDf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readGrowthModel</span> <span class="o">=</span> <span class="n">readGrowthModel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readTransfCoefs</span> <span class="o">=</span> <span class="n">readTransfCoefs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">earlyStage</span> <span class="o">=</span> <span class="n">earlyStage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readCropsRot</span> <span class="o">=</span> <span class="n">readCropsRot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readMeadows</span> <span class="o">=</span> <span class="n">readMeadows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createCropsRot</span> <span class="o">=</span> <span class="n">createCropsRot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createCropsHarvest</span> <span class="o">=</span> <span class="n">createCropsHarvest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createDryMass</span> <span class="o">=</span> <span class="n">createDryMass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readKFactor</span> <span class="o">=</span> <span class="n">readKFactor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcFK</span> <span class="o">=</span> <span class="n">calcFK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcFLS</span> <span class="o">=</span> <span class="n">calcFLS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readCTable</span> <span class="o">=</span> <span class="n">readCTable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readRTable</span> <span class="o">=</span> <span class="n">readRTable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcRadioactiveCont</span> <span class="o">=</span> <span class="n">calcRadioactiveCont</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportRadCont</span> <span class="o">=</span> <span class="n">exportRadCont</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_m</span> <span class="o">=</span> <span class="n">ls_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_n</span> <span class="o">=</span> <span class="n">ls_n</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Worker.run"><a class="viewcode-back" href="../libs.html#RadAgro.Worker.run">[dokumentace]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Running of worker thread - all calculations of the</span>
<span class="sd">        radioactivity contamination changes time series&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">perc</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Načítání &quot;</span>
                                         <span class="s2">&quot;vstupní vrstvy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="n">su_lyr_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suLyrPath</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Načítání vstupní &quot;</span>
                                 <span class="s2">&quot;vrstvy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="n">crops_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCropsPath</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">15</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Transformace &quot;</span>
                                         <span class="s2">&quot;rastrů&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="n">depo_path</span><span class="p">,</span> <span class="n">precip_path</span><span class="p">,</span> <span class="n">dmt_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadRasters</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Příprava &quot;</span>
                                         <span class="s2">&quot;dat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="n">df_crops_init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createCropsDf</span><span class="p">(</span><span class="n">crops_path</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">25</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Příprava &quot;</span>
                                         <span class="s2">&quot;dat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_growth_model_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readGrowthModel</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Příprava &quot;</span>
                                         <span class="s2">&quot;dat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_transf_coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readTransfCoefs</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">35</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Výpočet časné &quot;</span>
                                         <span class="s2">&quot;fáze&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">earlyStage</span><span class="p">(</span><span class="n">depo_path</span><span class="p">,</span> <span class="n">precip_path</span><span class="p">,</span> <span class="n">crops_path</span><span class="p">,</span>
                            <span class="n">df_crops_init</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">40</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Osevní &quot;</span>
                                         <span class="s2">&quot;postupy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_crops_rotation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCropsRot</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">45</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Osevní &quot;</span>
                                         <span class="s2">&quot;postupy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_meadows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readMeadows</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">50</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Osevní &quot;</span>
                                         <span class="s2">&quot;postupy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_crops_rotation_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createCropsRot</span><span class="p">(</span>
                <span class="n">df_crops_init</span><span class="p">,</span> <span class="n">df_crops_rotation</span><span class="p">,</span> <span class="n">df_meadows</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">55</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Osevní &quot;</span>
                                         <span class="s2">&quot;postupy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_crops_harvest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createCropsHarvest</span><span class="p">(</span>
                <span class="n">df_crops_init</span><span class="p">,</span> <span class="n">df_crops_rotation</span><span class="p">,</span> <span class="n">df_meadows</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">60</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Osevní &quot;</span>
                                         <span class="s2">&quot;postupy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span>
                <span class="n">perc</span><span class="p">)))</span>
            <span class="n">df_crops_dw_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createDryMass</span><span class="p">(</span><span class="n">df_crops_init</span><span class="p">,</span>
                                        <span class="n">df_growth_model_params</span><span class="p">,</span>
                                        <span class="n">df_crops_rotation</span><span class="p">,</span> <span class="n">df_meadows</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">65</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Eroze&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">k_factor_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readKFactor</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">70</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Eroze&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">k_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcFK</span><span class="p">(</span><span class="n">su_lyr_path</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">su_field</span><span class="p">,</span> <span class="n">k_factor_tab</span><span class="p">,</span>
                                        <span class="n">crops_path</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">75</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Eroze&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">ls_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcFLS</span><span class="p">(</span><span class="n">dmt_path</span><span class="p">,</span>
                                          <span class="n">crops_path</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_m</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">ls_factor_n</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">80</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Eroze&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">c_factor_tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCTable</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">85</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Eroze&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="n">r_perc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readRTable</span><span class="p">()</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">90</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Výpočet změn &quot;</span>
                                 <span class="s2">&quot;kontaminace&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calcRadioactiveCont</span><span class="p">(</span><span class="n">df_transf_coefs</span><span class="p">,</span>
                                     <span class="n">df_crops_rotation_all</span><span class="p">,</span>
                                     <span class="n">df_crops_harvest</span><span class="p">,</span>
                                     <span class="n">df_crops_dw_all</span><span class="p">,</span> <span class="n">k_factor</span><span class="p">,</span>
                                     <span class="n">ls_factor</span><span class="p">,</span> <span class="n">c_factor_tab</span><span class="p">,</span> <span class="n">r_perc</span><span class="p">)</span>

            <span class="n">perc</span> <span class="o">=</span> <span class="mi">95</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress_t</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{pr}</span><span class="s2"> %: Export &quot;</span>
                                         <span class="s2">&quot;dat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">perc</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportRadCont</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># forward the exception upstream</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worker.kill"><a class="viewcode-back" href="../libs.html#RadAgro.Worker.kill">[dokumentace]</a>    <span class="k">def</span> <span class="nf">kill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Kill the working thread.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="n">finished</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">progress</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">progress_t</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Dr. Jakub Brom, University of South Bohemia in České Budějovice, Faculty of Agriculture, Czech Republic.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>